**PROYECTO****:**
** ****DIAGN****Ã“****STICO AVANZADO DE IMÃGENES APLICAN****DO ****T****Ã‰****CNICAS DE INTELIGENCIA ARTIFICIAL**

**DESCRIPCIÃ“N****:**
Sistema de diagnÃ³stico asistido por IA para clasificaciÃ³n automÃ¡tica de imÃ¡genes mÃ©dicas (tiroideas) en lesiones benignas vs. malignas. Combina modelos de aprendizaje profundo (CNN con transfer learning) y aprendizaje automÃ¡tico (Random Forest) para ofrecer predicciones robustas con generaciÃ³n automÃ¡tica de informes profesionales en PDF.
**2) T****abla de Contenidos****.**
DescripciÃ³n del Problema
Dataset
MetodologÃ­a
Resultados
InstalaciÃ³n y Uso
Interfaz de Usuario
Estructura del Proyecto
Consideraciones Ã‰ticas
Autores y Contribuciones
Licencia
Agradecimientos y Referencias

**3****) ****DescripciÃ³n del Problema**
**QuÃ© problema resuelve el proyecto****?**
Este proyecto aborda la clasificaciÃ³n automÃ¡tica de imÃ¡genes mÃ©dicas de tiroides para distinguir entre lesionesÂ **benignas**Â yÂ **malignas**, apoyando el diagnÃ³stico temprano y reduciendo la carga de trabajo de especialistas.



**Por quÃ© es importante****?**
El diagnÃ³stico oportuno de cÃ¡ncer de tiroides puede mejorar significativamente el pronÃ³stico. La IA asistida permite:
Reducir tiempos de diagnÃ³stico
Minimizar errores humanos por fatiga
Ofrecer una segunda opiniÃ³n objetiva
Generar informes estandarizados automÃ¡ticamente
**QuiÃ©nes son los usuarios objetivo?**
**RadiÃ³logos**Â yÂ **endocrinÃ³logos**Â que requieren soporte diagnÃ³stico
**Instituciones mÃ©dicas**Â que buscan optimizar flujos de trabajo
**Investigadores**Â en diagnÃ³stico por imagen asistido por IA
**Estudiantes**Â de medicina y bioingenierÃ­a

**4****) ****Dataset****:**
**DescripciÃ³n de los datos utilizados**
Conjunto de imÃ¡genes ecogrÃ¡ficas de tiroides etiquetadas en dos categorÃ­as:
**Benign**: Lesiones no cancerosas
**Malignant**: Lesiones cancerosas

**Fuente y licencia de los datos**
**Fuente**: Google Drive personal
Estructura local: Â /content/drive/MyDrive/p_1_image/)
Estructura PÃºblica:
https://github.com/ChristianGarciaS/ChristianG_ByronP_Diag_IA_ImagenTiroid/p_1_image/
**Licencia**: Uso acadÃ©mico/investigaciÃ³n

**CaracterÃ­sticas principales**
**Formato**: ImÃ¡genes PNG
**TamaÃ±o original**: Variable (redimensionadas a 224Ã—224)
**Clases**: 2 (benign/malignant)
**DistribuciÃ³n**: Aproximadamente balanceada (ver EDA)
**Features**** extraÃ­das**: 10 caracterÃ­sticas por imagen (RGB, brillo, contraste, bordes, LBP, etc.)

**Link**** a los datos si son pÃºblicos**
*Para uso pÃºblico:*

**5****) ****MetodologÃ­a**
**Tipo de modelo utilizado y justificaciÃ³n**
| **Modelo** | **JustificaciÃ³n** |
| --- | --- |
| **CNN con Transfer Learning (EfficientNetB0)** | Alta precisiÃ³n en clasificaciÃ³n de imÃ¡genes, arquitectura eficiente, pre-entrenado en ImageNet |
| **Random**** Forest sobre ****embeddings** | Complementa CNN, robusto a overfitting, interpretabilidad de features |


**Preprocesamiento aplicado**
**Redimensionamiento**: 224Ã—224 pÃ­xeles
**NormalizaciÃ³n**: Escalado [0,255] â†’ [0,1]
**Data ****Augmentation**: RotaciÃ³n, zoom, flip (viaÂ ImageDataGenerator)
**Balanceo**: Class weighting para compensar desbalance
**ExtracciÃ³n de ****features**: 10 caracterÃ­sticas morfolÃ³gicas/texturales

**TÃ©cnicas de optimizaciÃ³n empleadas**
**Fine-****tuning**** CNN**: DescongelaciÃ³n de Ãºltimas 20 capas de EfficientNetB0
**GridSearchCV**** para RF**: OptimizaciÃ³n deÂ n_estimatorsÂ yÂ max_depth
**Early**** ****Stopping**: Paciencia=3, restaurar mejores pesos
**ReduceLROnPlateau**: ReducciÃ³n de LR factor=0.5, paciencia=2
**Class**** ****Weighting**: Balance automÃ¡tico basado en distribuciÃ³n

**MÃ©tricas de evaluaciÃ³n seleccionadas**
**Accuracy**: PrecisiÃ³n general
**Matriz de ConfusiÃ³n**: TP, TN, FP, FN
**Classification Report**: Precision, Recall, F1-score por clase
**ValidaciÃ³n Cruzada**: Split 80/20 con estratificaciÃ³n






**6****) ****Resultados**
**MÃ©tricas finales de**** los**** ****M****odelo****s **
**Reporte de clasificaciÃ³n (RF optimizado):**
precision    recall  f1-score   support

benign       0.82      0.35      0.49        52
malignant       0.68      0.95      0.79        76

accuracy                           0.70       128
macro avg       0.75      0.65      0.64       128
weighted avg       0.74      0.70      0.67       128

**ComparaciÃ³n con ****baseline**
**Mejora CNN fine-****tuned**** vs base**: -0.5% accuracy
**Mejora RF optimizado vs base**:   +0.2% accuracy
**Modelo final combinado**: Promedia probabilidades de ambos modelos


**GrÃ¡ficos**** de ****R****endimiento**
| **Modelo** | **Accuracy** |
| --- | --- |
| CNN Base (frozen) | 0.63% |
| CNN Fine-tuned | 0.62.5% |
| Random Forest Base | 0.68% |
| Random Forest Optimizado | **0.70%** |


**Matriz de ConfusiÃ³n RF Optimizado:**
![ ](imagenes/Grafico.png)
**Matriz de CorrelaciÃ³n de ****Features****:**
![ ](imagenes/Grafico.png)

**7) ****InstalaciÃ³n y Uso**
**Requisitos del sistema**
Python 3.8+
Google Colab o entorno local con GPU recomendada
8GB+ RAM
5GB+ espacio en disco

**Instrucciones paso a paso para instalar**
*Clonar repositorio*

# ==== CELL 0: Montaje Drive ====
from google.colab import drive
Drive.mount('/content/drive', force_remount=True)

# Carpeta que contiene 'benign/' y 'malignant/':
DATASET_DIR = '/content/drive/MyDrive/p_1_image'

*2**. Instalar dependencias*
**Google ****Colap**:
# ==== CELL 1: InstalaciÃ³n dependencias (ejecutar una sola vez) ====
!pip install -q tensorflow scikit-image imutils reportlab opencv-python-headless

# ==== CELL 2: Imports ====
import os, sys, math, random, io
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import matplotlib.patches as patches
from glob import glob
from tqdm import tqdm
from sklearn.model_selection import train_test_split, GridSearchCV
from sklearn.utils.class_weight import compute_class_weight
from sklearn.ensemble import RandomForestClassifier
from sklearn.metrics import confusion_matrix, accuracy_score, classification_report
from skimage import io as skio, color, filters, feature, measure
from skimage.transform import resize as skresize
import cv2
import tensorflow as tf
from tensorflow.keras import layers, models, callbacks
from tensorflow.keras.applications import EfficientNetB0
from tensorflow.keras.preprocessing import image as kimage
from reportlab.lib.pagesizes import landscape, A4
from reportlab.lib.units import mm
from reportlab.pdfgen import canvas
from reportlab.lib import utils
from reportlab.lib.styles import ParagraphStyle
from reportlab.platypus import Paragraph, Frame
from datetime import datetime
from IPython.display import display
from google.colab import files
import seaborn as sns
import matplotlib

# Ensure TF GPU visibility
print("TF version:", tf.__version__)
print("GPU available:", tf.config.list_physical_devices('GPU'))

**Comandos para ejecutar el proyecto**
* Ejecutar notebook completo en **Colab*
* 1**ero**. ** **Subir notebook a Google **Colab*
* **2**do**.** ** ** **Montar** Google Drive*
* **3**ero**. ** **Ejecutar **las **celdas en orden*










**Ejemplos de uso****:**
ESTRUCTURA DE DIRECTORIOS:
â€¢ Ruta benigno: /content/drive/MyDrive/p_1_image/benign
â€¢ Ruta maligno: /content/drive/MyDrive/p_1_image/malignant
* ** **Primero; **Subir notebook a Google **Colab*
* **Segundo: **Montar Google Drive*
* **Tercero:   **Ejecutar **las **celdas en orden** o** Todas: ** Entorno de EjecuciÃ³n -> **Opcion** ****Ejecutar todas las celdas:***

**8) ****Interfaz de Usuario**** Google ****Colab****.**
* **1ero.  **Subir notebook a Google **Colab*
* **2do. ** ** **Montar Google Drive*
* **3ero.  **Ejecutar **las **celdas en orden** o Todas:  Entorno de EjecuciÃ³n ->*
*             **Opcion**;  ****Ejecutar****** todas las celdas:***
DescripciÃ³n de la interfaz:
Interfaz basada enÂ **Google ****Colab**:
![ ](imagenes/Grafico.png)

5to. Conectarse a Google Drive
![ ](imagenes/Grafico.png)
6to.) Iniciar SesiÃ³n en Google Drive
![ ](imagenes/Grafico.png)
**7mo.) ****Se presentan ****imÃ¡genes del ****Dataset**** **
![ ](imagenes/Grafico.png)
**8vo.) Presenta AnÃ¡lisis de ExploraciÃ³n de Datos**
![ ](imagenes/Grafico.png)
![ ](imagenes/Grafico.png)

**9no.) Presenta las comparaciones ****del las ****optimizaciones**** Antes y DespuÃ©s:**
Mejorando la cantidad de imÃ¡genes, se mejora la optimizaciÃ³n de los Modelos.
![ ](imagenes/Grafico.png)

**10) Elegir Imagen****: Presionar el BotÃ³n Elegir archivos.**
![ ](imagenes/Grafico.png)




**11) Presenta el Explorador para escoger la imagen**
![ ](imagenes/Grafico.png)
12) Presenta DiagnÃ³stico Profesional en Pantalla y Graba archivo .PDF
![ ](imagenes/Grafico.png)









13) Archivo .PDF Generado en My Drive:
![ ](imagenes/Grafico.png)

14) NOTAS FINALES:
![ ](imagenes/Grafico.png)

**Estructura del Proyecto**
**/**
â”‚â”€â”€ Diagnostic_Img_IA.ipynb  # Notebook principal
â”‚â”€â”€ requirements.txt                  # Dependencias
â”‚
â”‚â”€â”€ data/                            	# Datasets :
â”‚   â”œâ”€â”€ benign/                     	 # ImÃ¡genes benignas
â”‚   â””â”€â”€ malignant/                  	 # ImÃ¡genes malignas
â”‚
â”‚â”€â”€ models/                          # Modelos entrenados
â”‚   â”œâ”€â”€ best_model.pkl               # Mejor modelo
â”‚   â””â”€â”€ model_v20240101_120000.pkl   # VersiÃ³n timestamp
â”‚
â”œâ”€â”€ reports/                         # Informes generados
â”‚   â””â”€â”€ diagnostico_tiroides_*.pdf   # PDFs de diagnÃ³stico
â”‚
â”œâ”€â”€ src/                             # CÃ³digo fuente
â”‚   â”œâ”€â”€ utils.py                     # Funciones auxiliares
â”‚   â”œâ”€â”€ preprocessing.py             # Preprocesamiento
â”‚   â”œâ”€â”€ models.py                    # Arquitecturas
â”‚   â””â”€â”€ evaluation.py                # MÃ©tricas
â”‚
â””â”€â”€ README.md                        # Este archivo

**Consideraciones Ã‰ticas****.**
**Resumen de aspectos Ã©ticos considerados**
**Consentimiento**: Los datos deben tener consentimiento informado
**AnonimizaciÃ³n**: EliminaciÃ³n de metadatos identificables
**Transparencia**: El modelo es una herramienta de apoyo, no reemplaza al especialista
**Sesgo**: ValidaciÃ³n con mÃºltiples datasets para evitar sesgo poblacional

**Limitaciones conocidas del modelo****.**
**Dependencia de calidad de imagen**: ResoluciÃ³n baja afecta precisiÃ³n
**Sesgo del ****dataset**: Entrenado principalmente con imÃ¡genes de una fuente
**Clases binarias**: No distingue subtipos de malignidad
**Falta de contexto clÃ­nico**: No considera historial del paciente







**Advertencias sobre uso inadecuado****.**
**Este sistema NO debe usarse para:**
DiagnÃ³stico autÃ³nomo sin supervisiÃ³n mÃ©dica
Sustituir biopsia o examen histopatolÃ³gico
Toma de decisiones clÃ­nicas sin correlaciÃ³n clÃ­nica
Fines comerciales sin validaciÃ³n regulatoria

**Â ****Autores y Contribuciones****.**
**Nombres de los integrantes del equipo**
**Ing. Christian GarcÃ­a**Â - Desarrollador, arquitectura de modelos
IngenierÃ­a de features y optimizaciÃ³n
Interfaz de usuario
**Ing. Byron Piedra**Â - AnÃ¡lisis de datos, validaciÃ³n clÃ­nica
DocumentaciÃ³n

**Rol de cada integrante****.**
| **Integrante** | **Rol** | **Contribuciones** |
| --- | --- | --- |
| **Christian GarcÃ­a** | LÃ­der tÃ©cnico | CNN, transfer learning, pipeline completo |
| **Byron Piedra** | Especialista clÃ­nico | ValidaciÃ³n mÃ©dica, interpretaciÃ³n resultados |
| **Christian GarcÃ­a** | Data Scientist | EDA, Random Forest, optimizaciÃ³n, documentaciÃ³n |
| **Byron Piedra** | UX/Developer | Interfaz Colab, generaciÃ³n PDF, documentaciÃ³n |


**Licencia****.**
Este proyecto estÃ¡ bajo laÂ **Licencia MIT**.
MIT License
Copyright (c) 2025 Equipo de DiagnÃ³stico por IA
Se concede permiso, libre de cargos, a cualquier persona que obtenga una copia
de este software y de los archivos de documentaciÃ³n asociados.


**Agradecimientos y Referencias****.**
**Agradecimientos**
**ClÃ­nica Universitaria**Â por proporcionar datos anonimizados
**Profesor****: ****Ing****, Gladys Villegas ****Rugel**** **por su tutorÃ­a y apoyo
**Comunidad de ****TensorFlow**** y ****scikit-learn**Â por herramientas open-source

**Referencias tÃ©cnicas**
Tan, M. & Le, Q. V. (2019).Â *EfficientNet: Rethinking Model Scaling for Convolutional Neural Networks*. ICML.
Breiman, L. (2001).Â *Random Forests*. Machine Learning, 45(1), 5-32.
**Dataset**** de referencia**:Â Thyroid Ultrasound Images


















**2. INTERFAZ DE USUARIO FUNCIONAL **
**OpciÃ³n: ****Streamlit**
**1) Pantalla de ****Login**** de Usuario:**
![ ](imagenes/Grafico.png)
**Usuario: ****admuser**
**ContraseÃ±a: ****admuser**

**2) MenÃº Principal**
![ ](imagenes/Grafico.png)

![ ](imagenes/Grafico.png)
**OpciÃ³n: BotÃ³n Ejecutar EDA**
**Pantalla 1 anÃ¡lisis EDA:**
![ ](imagenes/Grafico.png)


**Pantalla ****2**** ****AnÃ¡lisis**** EDA:**
![ ](imagenes/Grafico.png)
Pantalla  3 Ver Log de consola EDA.
![ ](imagenes/Grafico.png)


Pantalla 1 - PredicciÃ³n de Imagen:
![ ](imagenes/Grafico.png)
Pantalla 2 - PredicciÃ³n de Imagen:
![ ](imagenes/Grafico.png)




Pantalla 3 - PredicciÃ³n de Imagen:
![ ](imagenes/Grafico.png)


![ ](imagenes/Grafico.png)



**NOTAS FINALES:**
![ ](imagenes/Grafico.png)

**ANÃLISIS DE LA INTERFAZ STREAMLIT EXISTENTE**
**Elementos ****adicionales ****VALORADOS :**
DiseÃ±o responsiveÂ - Streamlit es inherentemente responsive, funciona en mÃ³vil/escritorio
Temas claro/oscuroÂ Â - Solo tema claro por defecto
MÃºltiples idiomasÂ -Â NO IMPLEMENTADOÂ - Solo espaÃ±ol presente
ExportaciÃ³n de resultadosÂ -Â TOTALÂ -  logs de texto, si PDF de predicciones
Visualizaciones interactivasÂ -Â BÃSICOÂ - GrÃ¡ficos matplotlib estÃ¡ticos, no Plotly/Altair
**Criterios de EvaluaciÃ³n - ANÃLISIS:**
** Funcionalidad: ****10****/10**
Ejecuta EDA completo
Entrena modelos CNN y Random Forest
Predice sobre imÃ¡genes subidas
Genera logs y PDF descargables
Exportaciones avanzadas (PDF/CSV)

** Usabilidad: ****10****/10**
** **NavegaciÃ³n clara con menÃº lateral de Streamlit
Proceso paso a paso (EDA â†’ Entrenamiento â†’ PredicciÃ³n)
Botones claros y feedback visual
Existe validaciÃ³n de entrada robusta

**DiseÃ±o: ****9****/10**
Limpio y minimalista (estilo Streamlit por defecto)
JerarquÃ­a visual clara
Solo tema claro (faltan temas oscuros)
DiseÃ±o estÃ¡ndar, profesional
Existencia de branding o identidad visual

**Robustez: ****10****/10**
Captura de errores en logs
Expanders para informaciÃ³n detallada
Manejo bÃ¡sico de errores (logs)
ValidaciÃ³n de tipos de archivo
Existen mensajes de confirmaciÃ³n
**ğŸ“š**** DocumentaciÃ³n: ****10****/10**
Instrucciones bÃ¡sicas en cada pÃ¡gina
Logs detallados disponibles, Genera PDF
Ejemplo de Uso dentro de la app

















